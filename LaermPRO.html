<!DOCTYPE html>
<html lang="de" data-theme="dark">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>LärmPRO – Lärmschutz in der Werkstatt</title>
  <meta name="description" content="Lärmintensive Tätigkeiten, gesundheitliche Folgen und Schutzmassnahmen. Für Automobilfachleute 1.–2. Lehrjahr.">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="style.css" />
  <script defer src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>

  <style>
    /* ========= Light Mode Lesbarkeit fix ========= */
    [data-theme="light"] body { color: rgba(15,23,42,0.92); }
    [data-theme="light"] .liquid-glass{
      background: rgba(255,255,255,0.70) !important;
      border-color: rgba(15,23,42,0.10) !important;
      box-shadow: 0 10px 30px rgba(2,6,23,0.10) !important;
      color: rgba(15,23,42,0.92) !important;
    }
    [data-theme="light"] .text-white{ color: rgba(15,23,42,0.92) !important; }
    [data-theme="light"] .text-white\/85{ color: rgba(15,23,42,0.85) !important; }
    [data-theme="light"] .text-white\/75{ color: rgba(15,23,42,0.78) !important; }
    [data-theme="light"] .text-white\/70{ color: rgba(15,23,42,0.70) !important; }
    [data-theme="light"] .text-white\/60{ color: rgba(15,23,42,0.60) !important; }

    [data-theme="light"] .bg-white\/5{ background: rgba(2,6,23,0.04) !important; }
    [data-theme="light"] .border-white\/10{ border-color: rgba(15,23,42,0.14) !important; }
    [data-theme="light"] .focus\:border-white\/20:focus{ border-color: rgba(15,23,42,0.22) !important; }
    [data-theme="light"] .focus\:ring-white\/10:focus{ --tw-ring-color: rgba(2,6,23,0.10) !important; }

    [data-theme="light"] .lg-badge,
    [data-theme="light"] .lg-chip{
      background: rgba(2,6,23,0.06) !important;
      border-color: rgba(15,23,42,0.10) !important;
      color: rgba(15,23,42,0.78) !important;
    }

    .hidden{ display:none !important; }
    .scroll-mt-24 { scroll-margin-top: 7rem; }

    /* Optional fallback progress bar */
    #scrollProgress{
      position: fixed; top: 0; left: 0; height: 3px; width: 0%;
      background: rgba(56,189,248,.85);
      z-index: 99999;
    }

    /* Rechner Inputs */
    .calc-input{
      width:100%;
      background: rgba(255,255,255,0.05);
      color: rgba(255,255,255,0.92);
      border: 1px solid rgba(255,255,255,0.10);
      border-radius: 12px;
      padding: 10px 12px;
      outline: none;
    }
    .calc-input:focus{
      border-color: rgba(255,255,255,0.20);
      box-shadow: 0 0 0 3px rgba(255,255,255,0.06);
    }
    [data-theme="light"] .calc-input{
      background: rgba(2,6,23,0.04) !important;
      color: rgba(15,23,42,0.92) !important;
      border-color: rgba(15,23,42,0.14) !important;
    }
    [data-theme="light"] .calc-input:focus{
      border-color: rgba(15,23,42,0.22) !important;
      box-shadow: 0 0 0 3px rgba(2,6,23,0.08) !important;
    }

    .pill{
      display:inline-flex; align-items:center; gap:8px;
      padding:6px 10px; border-radius:999px;
      border:1px solid rgba(255,255,255,0.12);
      background: rgba(255,255,255,0.06);
    }
    [data-theme="light"] .pill{
      border-color: rgba(15,23,42,0.12);
      background: rgba(2,6,23,0.04);
    }
  </style>
</head>

<body class="app">
  <!-- SVG Filter: “liquid / distortion” -->
  <svg class="svg-filters" width="0" height="0" aria-hidden="true" focusable="false">
    <filter id="glass-distortion">
      <feTurbulence type="fractalNoise" baseFrequency="0.012" numOctaves="2" seed="8" result="noise"/>
      <feDisplacementMap in="SourceGraphic" in2="noise" scale="14" xChannelSelector="R" yChannelSelector="G"/>
    </filter>
  </svg>

  <main class="page-wrap">
    <div class="max-w-5xl mx-auto p-5">

      <!-- Widgets -->
      <section class="liquid-glass lg-surface lg-radius-xl p-3 md:p-4 mb-6">
        <div class="flex flex-wrap items-center gap-2 md:gap-4">
          <div class="liquid-glass lg-chip lg-radius-md p-2.5 flex items-center gap-2.5">
            <div class="lg-icon"><i data-feather="calendar" class="w-4 h-4"></i></div>
            <div>
              <p class="lg-muted m-0">Date</p>
              <div class="font-extrabold" id="date">–</div>
            </div>
          </div>

          <div class="liquid-glass lg-chip lg-radius-md p-2.5 flex items-center gap-2.5">
            <div class="lg-icon"><i data-feather="clock" class="w-4 h-4"></i></div>
            <div>
              <p class="lg-muted m-0">Time</p>
              <div class="font-extrabold" id="time">–</div>
            </div>
          </div>

          <div class="lg-divider"></div>

          <div class="liquid-glass lg-chip lg-radius-md p-2.5 flex items-center gap-2.5">
            <div class="lg-icon"><i data-feather="cloud" class="w-4 h-4"></i></div>
            <div>
              <p class="lg-muted m-0">Weather · Bern</p>
              <div class="font-extrabold"><span id="wxText">–</span> · <span id="wxTemp">–°C</span></div>
            </div>
          </div>
        </div>
      </section>

      <!-- Search -->
      <section class="liquid-glass lg-surface lg-radius-xl p-3 md:p-4 mb-6 sticky top-2 md:top-4 z-20">
        <div class="flex flex-wrap items-center gap-2 md:gap-4">
          <div class="relative flex-1 min-w-[220px]">
            <i data-feather="search" class="absolute left-3 top-1/2 -translate-y-1/2 text-white/60 w-4 h-4"></i>
            <input id="q" type="search" placeholder="Suche (z. B. Schlagschrauber, Tinnitus, SNR...)"
              class="w-full bg-white/5 text-white border border-white/10 rounded-lg pl-9 pr-3 py-2.5 focus:outline-none focus:border-white/20 focus:ring-1 focus:ring-white/10">
          </div>

          <span class="pill text-xs text-white/60">
            <i data-feather="ear" class="w-4 h-4"></i>
            <span>1.–2. Lehrjahr</span>
          </span>
        </div>
      </section>

      <!-- Overview -->
      <section id="overview" class="scroll-mt-24">
        <div class="flex items-center justify-between mb-4">
          <h1 class="text-2xl sm:text-3xl font-bold">LärmPRO</h1>
        </div>

        <div id="grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 md:gap-4">
          <article class="liquid-glass lg-card lg-radius-lg p-4 flex flex-col gap-2.5 searchable" data-id="taetigkeiten">
            <div class="flex items-center gap-2 text-white/70">
              <i data-feather="activity" class="w-4 h-4"></i><span class="text-sm">Wo ist’s laut?</span>
            </div>
            <h3 class="text-lg font-bold m-0">1) Tätigkeiten</h3>
            <p class="text-white/75 m-0">Typische dB(A)-Bereiche in der Werkstatt.</p>
            <a class="lg-open mt-auto" href="#taetigkeiten">Öffnen <i data-feather="arrow-right" class="w-4 h-4"></i></a>
          </article>

          <article class="liquid-glass lg-card lg-radius-lg p-4 flex flex-col gap-2.5 searchable" data-id="folgen">
            <div class="flex items-center gap-2 text-white/70">
              <i data-feather="alert-triangle" class="w-4 h-4"></i><span class="text-sm">Gesundheit</span>
            </div>
            <h3 class="text-lg font-bold m-0">2) Folgen</h3>
            <p class="text-white/75 m-0">Hörschäden + Stress, Konzentration, Unfallrisiko.</p>
            <a class="lg-open mt-auto" href="#folgen">Öffnen <i data-feather="arrow-right" class="w-4 h-4"></i></a>
          </article>

          <article class="liquid-glass lg-card lg-radius-lg p-4 flex flex-col gap-2.5 searchable" data-id="schutz">
            <div class="flex items-center gap-2 text-white/70">
              <i data-feather="shield" class="w-4 h-4"></i><span class="text-sm">Massnahmen</span>
            </div>
            <h3 class="text-lg font-bold m-0">3) Schutz</h3>
            <p class="text-white/75 m-0">Technisch/orga. zuerst, PSA danach.</p>
            <a class="lg-open mt-auto" href="#schutz">Öffnen <i data-feather="arrow-right" class="w-4 h-4"></i></a>
          </article>

          <article class="liquid-glass lg-card lg-radius-lg p-4 flex flex-col gap-2.5 searchable" data-id="rechner">
            <div class="flex items-center gap-2 text-white/70">
              <i data-feather="cpu" class="w-4 h-4"></i><span class="text-sm">Rechner</span>
            </div>
            <h3 class="text-lg font-bold m-0">dB → Zeit</h3>
            <p class="text-white/75 m-0">Faustregel: +3 dB halbiert die Zeit.</p>
            <a class="lg-open mt-auto" href="#rechner">Öffnen <i data-feather="arrow-right" class="w-4 h-4"></i></a>
          </article>

          <article class="liquid-glass lg-card lg-radius-lg p-4 flex flex-col gap-2.5 searchable" data-id="quiz">
            <div class="flex items-center gap-2 text-white/70">
              <i data-feather="check-square" class="w-4 h-4"></i><span class="text-sm">Wissen</span>
            </div>
            <h3 class="text-lg font-bold m-0">Mini-Quiz</h3>
            <p class="text-white/75 m-0">4 kurze Fragen, sofort Feedback.</p>
            <a class="lg-open mt-auto" href="#quiz">Öffnen <i data-feather="arrow-right" class="w-4 h-4"></i></a>
          </article>

          <article class="liquid-glass lg-card lg-radius-lg p-4 flex flex-col gap-2.5 searchable" data-id="glossar">
            <div class="flex items-center gap-2 text-white/70">
              <i data-feather="book-open" class="w-4 h-4"></i><span class="text-sm">Begriffe</span>
            </div>
            <h3 class="text-lg font-bold m-0">Glossar</h3>
            <p class="text-white/75 m-0">dB(A), SNR, Exposition.</p>
            <a class="lg-open mt-auto" href="#glossar">Öffnen <i data-feather="arrow-right" class="w-4 h-4"></i></a>
          </article>
        </div>

        <div id="empty" class="opacity-75 text-center p-4 border border-dashed border-white/15 rounded-xl hidden" aria-live="polite">
          Keine Treffer
        </div>
      </section>

      <!-- 1) Tätigkeiten -->
      <section id="taetigkeiten" class="mt-6 scroll-mt-24">
        <div class="liquid-glass lg-surface lg-radius-xl p-4 md:p-5">
          <h2 class="text-xl font-bold mb-2 flex items-center gap-2">
            <i data-feather="activity" class="w-5 h-5 text-sky-300"></i><span>1) Lärmintensive Tätigkeiten</span>
          </h2>
          <p class="text-white/70 text-sm mb-3">
            Richtwerte (typische Bereiche). Konkrete Werte hängen von Maschine, Abstand und Raum ab.
          </p>

          <div class="overflow-x-auto liquid-glass lg-card lg-radius-lg p-3 border border-white/10">
            <table class="w-full text-sm">
              <thead class="text-white/70">
                <tr class="border-b border-white/10">
                  <th class="text-left py-2 pr-3">Tätigkeit / Gerät</th>
                  <th class="text-left py-2 pr-3">Typisch dB(A)</th>
                  <th class="text-left py-2">Hinweis</th>
                </tr>
              </thead>
              <tbody class="text-white/80">
                <tr class="border-b border-white/10">
                  <td class="py-2 pr-3">Winkelschleifer / Trennschleifer</td>
                  <td class="py-2 pr-3">95–105</td>
                  <td class="py-2">Scheibe passend, Schutzhaube dran.</td>
                </tr>
                <tr class="border-b border-white/10">
                  <td class="py-2 pr-3">Druckluft (Abblasen)</td>
                  <td class="py-2 pr-3">90–100</td>
                  <td class="py-2">Blaspistole mit Schalldämpfer.</td>
                </tr>
                <tr class="border-b border-white/10">
                  <td class="py-2 pr-3">Schlagschrauber</td>
                  <td class="py-2 pr-3">92–100</td>
                  <td class="py-2">Leisere Modelle/Schalldämpfer nutzen.</td>
                </tr>
                <tr class="border-b border-white/10">
                  <td class="py-2 pr-3">Hämmern / Karosseriearbeiten</td>
                  <td class="py-2 pr-3">85–100</td>
                  <td class="py-2">Gedämpfte Unterlagen (Matten).</td>
                </tr>
                <tr class="border-b border-white/10">
                  <td class="py-2 pr-3">Motorlauf/Prüfstände</td>
                  <td class="py-2 pr-3">85–100</td>
                  <td class="py-2">Abgas/Schalldämpfer richtig anschließen.</td>
                </tr>
                <tr class="border-b border-white/10">
                  <td class="py-2 pr-3">Reifenmontier-/Wuchtmaschinen</td>
                  <td class="py-2 pr-3">80–90</td>
                  <td class="py-2">Wartung hilft: Lager, Rollen, Abdeckungen.</td>
                </tr>
                <tr class="border-b border-white/10">
                  <td class="py-2 pr-3">Hochdruckreiniger</td>
                  <td class="py-2 pr-3">85–95</td>
                  <td class="py-2">Düse prüfen, Abstand halten.</td>
                </tr>
                <tr>
                  <td class="py-2 pr-3">Hallenverkehr (Stapler/Transport)</td>
                  <td class="py-2 pr-3">80–90</td>
                  <td class="py-2">Fahrwege, ruhige Kommunikation.</td>
                </tr>
              </tbody>
            </table>
          </div>

          <div class="mt-3 liquid-glass lg-chip lg-radius-md p-3 text-white/75 text-sm">
            <b>Merke:</b> <b>+3 dB</b> bedeutet ungefähr <b>doppelte Schallenergie</b> am Ohr → die <b>zulässige Zeit halbiert sich</b>.
          </div>
        </div>
      </section>

      <!-- 2) Folgen -->
      <section id="folgen" class="mt-6 scroll-mt-24">
        <div class="liquid-glass lg-surface lg-radius-xl p-4 md:p-5">
          <h2 class="text-xl font-bold mb-3 flex items-center gap-2">
            <i data-feather="alert-triangle" class="w-5 h-5 text-amber-300"></i><span>2) Gesundheitliche Folgen</span>
          </h2>

          <div class="grid grid-cols-1 lg:grid-cols-2 gap-3">
            <div class="liquid-glass lg-card lg-radius-lg p-4">
              <h3 class="font-bold mb-2">Am Ohr</h3>
              <ul class="text-white/75 text-sm space-y-2">
                <li><b>Vorübergehend schlechter hören</b> (Dämmungsgefühl nach lauter Arbeit).</li>
                <li><b>Tinnitus</b> (Pfeifen/Rauschen).</li>
                <li><b>Dauerhafte Hörminderung</b>: Haarzellen werden geschädigt und kommen nicht zurück.</li>
              </ul>
            </div>

            <div class="liquid-glass lg-card lg-radius-lg p-4">
              <h3 class="font-bold mb-2">Im Alltag/bei der Arbeit</h3>
              <ul class="text-white/75 text-sm space-y-2">
                <li><b>Stress</b>, Müdigkeit, schlechter Schlaf.</li>
                <li><b>Weniger Konzentration</b> → <b>Unfallgefahr</b> steigt.</li>
                <li>Langfristig mehr Belastung fürs <b>Herz-Kreislauf-System</b> (z. B. Blutdruck).</li>
              </ul>
            </div>
          </div>

          <div class="mt-3 liquid-glass lg-chip lg-radius-md p-3 text-white/75 text-sm">
            <b>Praxisregel:</b> Ab ungefähr <b>85 dB(A)</b> braucht es wirksamen Gehörschutz oder klare Massnahmen.
          </div>
        </div>
      </section>

      <!-- 3) Schutz -->
      <section id="schutz" class="mt-6 scroll-mt-24">
        <div class="liquid-glass lg-surface lg-radius-xl p-4 md:p-5">
          <h2 class="text-xl font-bold mb-3 flex items-center gap-2">
            <i data-feather="shield" class="w-5 h-5 text-emerald-300"></i><span>3) Schutzmassnahmen</span>
          </h2>

          <div class="grid grid-cols-1 lg:grid-cols-2 gap-3">
            <div class="liquid-glass lg-card lg-radius-lg p-4">
              <h3 class="font-bold mb-2">Reihenfolge (wichtig)</h3>
              <ol class="text-white/75 text-sm space-y-2 list-decimal pl-5">
                <li><b>Technisch:</b> leiseres Werkzeug, Schalldämpfer, Einhausung, Dämpfung.</li>
                <li><b>Organisatorisch:</b> Arbeitszeit begrenzen, rotieren, Ruhezonen, Hinweisschilder.</li>
                <li><b>PSA:</b> Gehörschutz (Stöpsel/Kapseln) korrekt benutzen.</li>
              </ol>

              <div class="mt-3 text-white/60 text-sm">
                Nicht sexy, aber effektiv: Wartung. Defekte Lager und lockere Teile machen oft unnötig Lärm.
              </div>
            </div>

            <div class="liquid-glass lg-card lg-radius-lg p-4">
              <h3 class="font-bold mb-2">PSA kurz erklärt</h3>
              <ul class="text-white/75 text-sm space-y-2">
                <li><b>Stöpsel:</b> richtige Größe, tief genug einsetzen (dicht!).</li>
                <li><b>Kapseln:</b> Polster dicht, Brillenbügel können abdichten verschlechtern.</li>
                <li><b>SNR (Dämmwert):</b> Ziel am Ohr grob <b>70–80 dB(A)</b>. Zu wenig schützt nicht, zu viel kann Kommunikation gefährlich machen.</li>
                <li><b>Kombi</b> (Stöpsel + Kapsel) nur bei sehr hohen Pegeln/kurzzeitig.</li>
              </ul>
              <div class="mt-3 liquid-glass lg-chip lg-radius-md p-3 text-white/75 text-sm">
                <b>Praxis-Check:</b> Nach Einsetzen klingt deine eigene Stimme dumpfer? Dann sitzt es meistens besser.
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Rechner -->
      <section id="rechner" class="mt-6 scroll-mt-24">
        <div class="liquid-glass lg-surface lg-radius-xl p-4 md:p-5">
          <h2 class="text-xl font-bold mb-2 flex items-center gap-2">
            <i data-feather="cpu" class="w-5 h-5 text-sky-300"></i><span>Rechner: dB(A) → maximale Tageszeit</span>
          </h2>
          <p class="text-white/60 text-sm mb-4">
            Faustregel (Halbierungsregel): <b>85 dB(A) ≈ 8 h</b>, jede <b>+3 dB</b> halbiert die sichere Zeit.
          </p>

          <div class="grid grid-cols-1 lg:grid-cols-2 gap-3">
            <div class="liquid-glass lg-card lg-radius-lg p-4">
              <label class="text-white/70 text-xs">Pegel (dB(A))</label>
              <input id="db" class="calc-input mt-1" type="number" min="70" max="120" step="1" value="95" />

              <div class="mt-3 liquid-glass lg-chip lg-radius-md p-3">
                <div class="text-white/60 text-xs">Zeitlimit heute</div>
                <div class="text-2xl font-extrabold" id="timeOut">–</div>
                <div class="text-white/70 text-sm mt-1" id="timeSub">–</div>
              </div>

              <div class="mt-3 text-white/60 text-sm" id="formula">
                Formel: T = 8 h · 0,5^((dB−85)/3)
              </div>

              <div class="mt-3 flex flex-wrap gap-2">
                <button id="resetCalc" class="lg-btn">
                  <i data-feather="rotate-ccw" class="w-4 h-4"></i><span>Reset</span>
                </button>
                <span class="pill text-xs text-white/60">
                  <i data-feather="info" class="w-4 h-4"></i>
                  <span>Richtwert, ersetzt keine Messung</span>
                </span>
              </div>
            </div>

            <div class="liquid-glass lg-card lg-radius-lg p-4 overflow-x-auto">
              <div class="text-white/60 text-xs mb-2">Referenz (typisch)</div>
              <table class="w-full text-sm">
                <thead class="text-white/70">
                  <tr class="border-b border-white/10">
                    <th class="text-left py-2 pr-3">Pegel</th>
                    <th class="text-left py-2">Max. Zeit/Tag</th>
                  </tr>
                </thead>
                <tbody id="tblRef" class="text-white/80"></tbody>
              </table>
            </div>
          </div>
        </div>
      </section>

      <!-- Quiz -->
      <section id="quiz" class="mt-6 scroll-mt-24">
        <div class="liquid-glass lg-surface lg-radius-xl p-4 md:p-5">
          <h2 class="text-xl font-bold mb-3 flex items-center gap-2">
            <i data-feather="check-square" class="w-5 h-5 text-emerald-300"></i><span>Mini-Quiz</span>
          </h2>

          <div class="grid grid-cols-1 lg:grid-cols-2 gap-3" id="quizGrid">
            <div class="liquid-glass lg-card lg-radius-lg p-4 q">
              <p class="text-white/85 mb-2"><b>A:</b> +3 dB bedeuten…</p>
              <select class="calc-input" data-answer="halbe">
                <option value="">Antwort wählen…</option>
                <option value="gleiche">gleiche erlaubte Zeit</option>
                <option value="halbe">halbe erlaubte Zeit</option>
                <option value="doppelte">doppelte erlaubte Zeit</option>
              </select>
              <div class="text-sm mt-2 text-white/60 fb"></div>
            </div>

            <div class="liquid-glass lg-card lg-radius-lg p-4 q">
              <p class="text-white/85 mb-2"><b>B:</b> Welche Reihenfolge ist richtig?</p>
              <select class="calc-input" data-answer="technik">
                <option value="">Antwort wählen…</option>
                <option value="psa">Zuerst PSA, dann technische Massnahmen</option>
                <option value="technik">Zuerst technische/orga., dann PSA</option>
              </select>
              <div class="text-sm mt-2 text-white/60 fb"></div>
            </div>

            <div class="liquid-glass lg-card lg-radius-lg p-4 q">
              <p class="text-white/85 mb-2"><b>C:</b> Ab ungefähr welchem Pegel wird Schutz wichtig?</p>
              <select class="calc-input" data-answer="85">
                <option value="">Antwort wählen…</option>
                <option value="75">~75 dB(A)</option>
                <option value="85">~85 dB(A)</option>
                <option value="100">~100 dB(A)</option>
              </select>
              <div class="text-sm mt-2 text-white/60 fb"></div>
            </div>

            <div class="liquid-glass lg-card lg-radius-lg p-4 q">
              <p class="text-white/85 mb-2"><b>D:</b> Gehörschutz ist korrekt, wenn…</p>
              <select class="calc-input" data-answer="dicht">
                <option value="">Antwort wählen…</option>
                <option value="locker">er locker sitzt</option>
                <option value="dicht">er dicht abschliesst</option>
                <option value="nurlinks">nur links getragen wird</option>
              </select>
              <div class="text-sm mt-2 text-white/60 fb"></div>
            </div>
          </div>

          <div class="mt-3 flex flex-wrap items-center gap-2">
            <button id="checkBtn" class="lg-btn">
              <i data-feather="check" class="w-4 h-4"></i><span>Prüfen</span>
            </button>
            <button id="resetBtn" class="lg-btn">
              <i data-feather="trash-2" class="w-4 h-4"></i><span>Reset</span>
            </button>
            <span class="pill text-sm text-white/70" id="score">Punkte: 0/4</span>
          </div>
        </div>
      </section>

      <!-- Glossar -->
      <section id="glossar" class="mt-6 scroll-mt-24">
        <div class="liquid-glass lg-surface lg-radius-xl p-4 md:p-5">
          <h2 class="text-xl font-bold mb-2 flex items-center gap-2">
            <i data-feather="book-open" class="w-5 h-5 text-sky-300"></i><span>Glossar</span>
          </h2>
          <ul class="text-white/75 text-sm space-y-2">
            <li><b>dB(A):</b> Lautstärkemass mit A-Bewertung (ähnlich menschlichem Hören).</li>
            <li><b>SNR:</b> Dämmwert von Gehörschutz (je höher, desto mehr Dämpfung).</li>
            <li><b>Expositionszeit:</b> Zeit pro Tag, die ein Pegel “sicher” anliegen darf (Richtwert).</li>
          </ul>
          <div class="mt-3 text-white/60 text-sm">
            Hinweis: Werte/Regeln sind Lehr-/Praxis-Hilfen. Im Betrieb gelten Messungen/Vorschriften.
          </div>
        </div>
      </section>

      <div class="text-white/60 text-xs text-center my-10">
        <div class="liquid-glass lg-chip lg-radius-pill inline-flex items-center gap-2 px-4 py-2">
          <span>© LearnCraft Pro</span>
          <span class="w-1 h-1 rounded-full bg-white/30"></span>
          <span>LärmPRO</span>
        </div>
      </div>

    </div>
  </main>

  <!-- Bottom Bar: NUR 3 Buttons -->
  <nav id="bottomBar" class="liquid-glass bottom-bar lg-radius-pill" aria-label="Navigation">
    <a class="bar-item active" href="Index.html" aria-label="Home">
      <i data-feather="home" class="bar-icon"></i>
      <span class="bar-label">Home</span>
    </a>

    <a class="bar-item" href="#overview" data-target="overview" aria-label="Übersicht">
      <i data-feather="grid" class="bar-icon"></i>
      <span class="bar-label">Übersicht</span>
    </a>

    <button id="themeToggle" class="bar-item" type="button" aria-label="Theme wechseln">
      <i id="themeIcon" data-feather="sun" class="bar-icon"></i>
      <span class="bar-label">Theme</span>
    </button>
  </nav>

  <div id="scrollProgress"></div>

  <script>
    const $ = (s, r=document) => r.querySelector(s);

    /* Icons */
    document.addEventListener('DOMContentLoaded', () => {
      if (window.feather) feather.replace();
    });

    /* Theme */
    (function themeInit(){
      const html = document.documentElement;
      const btn = document.getElementById('themeToggle');
      const icon = document.getElementById('themeIcon');

      function applyTheme(mode){
        html.setAttribute('data-theme', mode);
        localStorage.setItem('theme', mode);
        if (icon) icon.setAttribute('data-feather', mode === 'dark' ? 'sun' : 'moon');
        if (window.feather) feather.replace();
      }
      applyTheme(localStorage.getItem('theme') || 'dark');
      btn?.addEventListener('click', () => {
        const current = html.getAttribute('data-theme') || 'dark';
        applyTheme(current === 'dark' ? 'light' : 'dark');
      });
    })();

    /* Date/Time */
    function updateDateTime() {
      const now = new Date();
      const d = document.getElementById('date');
      const t = document.getElementById('time');
      if (d) d.textContent = now.toLocaleDateString('de-CH', {weekday:'long', day:'numeric', month:'long', year:'numeric'});
      if (t) t.textContent = now.toLocaleTimeString('de-CH');
    }
    setInterval(updateDateTime, 1000);
    updateDateTime();

    /* Weather (simple) */
    async function fetchWeather(){
      try{
        const res = await fetch('https://wttr.in/Bern?format=%25C|%25t', {cache:'no-store'});
        const text = await res.text();
        const [c,temp] = (text||'').split('|');
        const wxT = document.getElementById('wxText');
        const wxTemp = document.getElementById('wxTemp');
        if (wxT) wxT.textContent = c || '–';
        if (wxTemp) wxTemp.textContent = (temp||'–').replace('+','');
      }catch(e){}
    }
    fetchWeather();

    /* Smooth anchors */
    document.addEventListener('click', (e)=>{
      const a = e.target.closest('a[href^="#"]');
      if(!a) return;
      const id = a.getAttribute('href').slice(1);
      const el = document.getElementById(id);
      if(!el) return;
      e.preventDefault();
      el.scrollIntoView({behavior:'smooth', block:'start'});
    });

    /* Search: filter overview cards */
    function normalize(text) {
      return (text || '').toLowerCase().normalize('NFKD').replace(/[\u0300-\u036f]/g, '');
    }
    const searchInput = document.getElementById('q');
    const grid = document.getElementById('grid');
    const emptyState = document.getElementById('empty');
    const cards = grid ? [...grid.querySelectorAll('.searchable')] : [];

    function performSearch() {
      const q = normalize((searchInput?.value || '').trim());
      let has = false;
      cards.forEach(card => {
        const text = normalize(card.innerText);
        const ok = !q || text.includes(q);
        card.style.display = ok ? 'flex' : 'none';
        if (ok) has = true;
      });
      if (emptyState) emptyState.style.display = has ? 'none' : 'block';
    }
    searchInput?.addEventListener('input', performSearch);

    /* Bottom bar active state (Übersicht) */
    (function barActive(){
      const overviewBtn = document.querySelector('#bottomBar a[data-target="overview"]');
      const overview = document.getElementById('overview');
      if (!overviewBtn || !overview) return;

      const obs = new IntersectionObserver((entries)=>{
        const v = entries[0];
        overviewBtn.classList.toggle('active', !!v?.isIntersecting);
      }, { rootMargin: '-40% 0px -55% 0px', threshold: 0.08 });

      obs.observe(overview);
    })();

    /* Scroll progress */
    (function(){
      const progress = document.getElementById('scrollProgress');
      const onScroll = () => {
        const h = document.documentElement;
        const denom = (h.scrollHeight - h.clientHeight) || 1;
        progress.style.width = (h.scrollTop / denom * 100).toFixed(2) + '%';
      };
      document.addEventListener('scroll', onScroll, {passive:true});
      onScroll();
    })();

    /* Rechner: dB -> Zeit (live) */
    function timeForDb(db){
      const baseDb = 85, baseH = 8;
      const steps = (db - baseDb) / 3;
      return baseH * Math.pow(0.5, steps);
    }
    function fmtTime(h){
      if (!Number.isFinite(h) || h <= 0) return '–';
      const m = Math.max(0, Math.round(h * 60));
      if (m >= 60) {
        const hh = Math.floor(m / 60), mm = m % 60;
        return `${hh} h ${mm} min`;
      }
      return `${m} min`;
    }
    (function setupCalc(){
      const dbEl = document.getElementById('db');
      const out = document.getElementById('timeOut');
      const sub = document.getElementById('timeSub');
      const ref = document.getElementById('tblRef');
      const reset = document.getElementById('resetCalc');

      function fillRef(){
        const vals = [85,88,91,94,97,100,103,106];
        ref.innerHTML = vals.map(v => {
          const t = fmtTime(timeForDb(v));
          return `<tr class="border-b border-white/10 last:border-b-0">
            <td class="py-2 pr-3">${v} dB(A)</td>
            <td class="py-2">${t}</td>
          </tr>`;
        }).join('');
      }

      function run(){
        const db = parseFloat(String(dbEl.value || '').replace(',', '.'));
        const h = timeForDb(db);
        out.textContent = fmtTime(h);
        sub.textContent = Number.isFinite(db)
          ? `Bei ${db} dB(A) nach Halbierungsregel`
          : 'Bitte gültigen Pegel eingeben.';
      }

      dbEl.addEventListener('input', run);
      reset.addEventListener('click', () => { dbEl.value = 95; run(); });

      fillRef();
      run();
    })();

    /* Quiz */
    (function quiz(){
      const qs = Array.from(document.querySelectorAll('#quiz .q'));
      const score = document.getElementById('score');
      const checkBtn = document.getElementById('checkBtn');
      const resetBtn = document.getElementById('resetBtn');

      function update(){
        let p = 0;
        qs.forEach(card => {
          const sel = card.querySelector('select');
          const fb = card.querySelector('.fb');
          const ok = sel.value && sel.value === sel.dataset.answer;
          if (sel.value){
            fb.textContent = ok ? '✅ richtig' : '❌ falsch';
            fb.className = 'text-sm mt-2 ' + (ok ? 'text-emerald-300' : 'text-red-300') + ' fb';
          } else {
            fb.textContent = '';
            fb.className = 'text-sm mt-2 text-white/60 fb';
          }
          if (ok) p++;
        });
        score.textContent = `Punkte: ${p}/4`;
      }

      qs.forEach(card => card.querySelector('select').addEventListener('change', update));
      checkBtn.addEventListener('click', update);
      resetBtn.addEventListener('click', () => {
        qs.forEach(card => {
          card.querySelector('select').value = '';
          card.querySelector('.fb').textContent = '';
        });
        update();
      });
      update();
    })();
  </script>
</body>
</html>
